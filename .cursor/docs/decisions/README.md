# Decision Log 索引

> **目的**：记录重大决策的讨论过程、关键争论点、最终决策和理由

---

## 📚 什么是 Decision Log？

Decision Log 是**讨论过程的记录**，不同于正式的 ADR（架构决策记录）：

| 文档类型 | Decision Log | ADR |
|---------|-------------|-----|
| **目的** | 记录讨论过程 | 正式的决策文档 |
| **内容** | 问题、方案对比、争论、选择理由 | 决策内容、技术实现、影响 |
| **受众** | 开发团队（了解为什么这样决策） | 所有人（了解当前架构） |
| **位置** | `.cursor/docs/decisions/` | `docs/03-decisions/` |
| **格式** | 相对自由（讨论式） | 严格模板（ADR标准） |

---

## 🗂️ Decision Log 列表

| 日期 | 标题 | 状态 | 关键洞察 | 相关 ADR |
|-----|------|------|---------|---------|
| 2025-11-08 | [UESCA 训练强度分配原则修正](2025-11-08_UESCA-intensity-distribution-correction.md) | ✅ 已决策 | 先看代码再评估，证据优先（辨证思考铁律） | 无（文档修正） |
| 2025-11-07 | [PlanSyncService 架构债务](2025-11-07_PlanSyncService-Architecture-Debt.md) | ✅ 已决策 | AI 生成数据未覆盖在 ADR-010 中 | [ADR-010](../../../docs/03-decisions/ADR-010-offline-sync-strategy.md) |
| 2025-11-07 | [双向数据流架构决策](2025-11-07_dual-data-flow-architecture.md) | ✅ 已决策 | 数据流方向 ≠ CloudBase 迁移难度 | [ADR-015](../../../docs/03-decisions/ADR-015-server-initiated-data-sync.md) |
| 2025-11-07 | [会话决策日志](2025-11-07_Session_Decision_Log.md) | 🟡 讨论中 | Week 6-7 修复过程的决策记录 | 多个 |
| 2025-11-07 | [Golden Context](2025-11-07_Golden_Context.md) | 📋 参考 | Week 7 的 Golden Context | - |
| 2025-11-06 | [Pre-Week8 关键决策](2025-11-06_Pre-Week8_Key_Decisions.md) | ✅ 已决策 | Week 8 前的准备决策 | - |
| 2025-11-07 | [Pre-Week8 关键决策 v2](2025-11-07_Pre-Week8_Key_Decisions.md) | ✅ 已决策 | Week 8 前的准备决策（更新版） | - |

---

## 📝 何时创建 Decision Log？

### ✅ 应该创建

1. **重大架构决策前**
   - 有多个方案需要对比
   - 需要记录权衡过程
   - 例：单向流 vs 双向流

2. **发现架构矛盾/冲突时**
   - 用户质疑某个设计
   - 发现文档与实现不一致
   - 例：Week 7 发现 ADR-010 未覆盖 AI 生成数据场景

3. **复杂问题的根因分析**
   - Bug 的深层原因
   - 性能问题的优化方案
   - 例：PlanSyncService 设计缺陷分析

### ❌ 不需要创建

1. **简单的实现细节**
   - 直接记录到 Changelog 即可

2. **已有明确方案的功能**
   - 不需要讨论，直接实施

3. **日常 Bug 修复**
   - 除非涉及架构层面的问题

---

## 🔄 Decision Log → ADR 的流程

```
1. 发现问题/冲突
   ↓
2. 创建 Decision Log（记录讨论）
   ↓
3. 经过充分讨论，达成共识
   ↓
4. 决策成熟 → 整理为正式 ADR
   ↓
5. ADR 移到 docs/03-decisions/
   ↓
6. Decision Log 保留（追溯讨论过程）
```

---

## 📋 Decision Log 模板

创建新 Decision Log 时，使用以下结构：

```markdown
# Decision Log - [简短标题]

> **日期**: YYYY-MM-DD HH:MM  
> **参与者**: 用户 + AI助手  
> **状态**: 🟡 讨论中 / ✅ 已决策 / ⚠️ 有争议  
> **影响范围**: [架构/功能/Bug修复]

---

## 🎯 背景与问题

[用户发现了什么问题？为什么讨论？]

---

## 💬 讨论过程

### 用户的观点
- [用户提出的问题/质疑]
- [用户的倾向]

### AI的分析
- [AI提出的方案A]
- [AI提出的方案B]
- [优缺点对比]

### 关键争论点
- [哪里有分歧？]
- [如何解决的？]

---

## ✅ 最终决策

**选择方案**: [A/B/C/混合]

**理由**:
1. [原因1]
2. [原因2]

**权衡**:
- ✅ 优点：[...]
- ⚠️ 代价：[...]

---

## 📋 后续行动

- [ ] 更新文档：[哪些文档需要更新]
- [ ] 修改代码：[哪些代码需要改]
- [ ] 创建ADR：[是否需要正式ADR]
- [ ] 标记技术债：[是否有未解决的问题]

---

## 🔗 相关文档

- [相关 ADR](...)
- [相关实现文档](...)
```

---

## 🔍 快速查找

### 按主题分类

**架构设计**：
- [双向数据流架构决策](2025-11-07_dual-data-flow-architecture.md)（2025-11-07）

**数据同步**：
- [双向数据流架构决策](2025-11-07_dual-data-flow-architecture.md)（涉及 CloudBase 迁移）

**Bug 根因分析**：
- （待添加）

---

## 🎯 维护指南

### 定期维护（每月）

1. **清理过期的 Decision Log**
   - 已升级为 ADR 的 → 保留（追溯用）
   - 已废弃的方案 → 标记状态 ❌，保留 3 个月后删除

2. **更新索引**
   - 按主题分类
   - 添加关键词搜索

3. **评估决策效果**
   - 回顾已实施的决策
   - 记录经验教训

---

**创建日期**: 2025-11-07  
**维护者**: 开发团队

